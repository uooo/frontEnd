<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="shortcut icon" href="https://s1.ax1x.com/2022/06/17/XqwCNj.png"><title>MongoDB | AH</title><meta name="description" content="前端学习笔记">
    <link rel="modulepreload" href="/frontEnd/assets/app.a5758758.js"><link rel="modulepreload" href="/frontEnd/assets/MongoDB.html.7ff528d4.js"><link rel="modulepreload" href="/frontEnd/assets/MongoDB.html.d1e2b358.js"><link rel="prefetch" href="/frontEnd/assets/index.html.09d60eb4.js"><link rel="prefetch" href="/frontEnd/assets/me.html.17785e39.js"><link rel="prefetch" href="/frontEnd/assets/index.html.daa93eb2.js"><link rel="prefetch" href="/frontEnd/assets/thisproject.html.899e58e3.js"><link rel="prefetch" href="/frontEnd/assets/index.html.65627eb3.js"><link rel="prefetch" href="/frontEnd/assets/css.html.0bc15502.js"><link rel="prefetch" href="/frontEnd/assets/html.html.9a4a9ec1.js"><link rel="prefetch" href="/frontEnd/assets/JavaScript.html.f191eef5.js"><link rel="prefetch" href="/frontEnd/assets/Git.html.abe6be2f.js"><link rel="prefetch" href="/frontEnd/assets/nodejs.html.b85d02ee.js"><link rel="prefetch" href="/frontEnd/assets/npm.html.c5e3b979.js"><link rel="prefetch" href="/frontEnd/assets/index.html.a57e6214.js"><link rel="prefetch" href="/frontEnd/assets/webpack.html.27a51359.js"><link rel="prefetch" href="/frontEnd/assets/vue.html.4146528a.js"><link rel="prefetch" href="/frontEnd/assets/vuepress.html.9a31327c.js"><link rel="prefetch" href="/frontEnd/assets/404.html.265028f6.js"><link rel="prefetch" href="/frontEnd/assets/index.html.d1f47cdd.js"><link rel="prefetch" href="/frontEnd/assets/me.html.3a541e8f.js"><link rel="prefetch" href="/frontEnd/assets/index.html.65b778e8.js"><link rel="prefetch" href="/frontEnd/assets/thisproject.html.9c6bbeec.js"><link rel="prefetch" href="/frontEnd/assets/index.html.b0ca9655.js"><link rel="prefetch" href="/frontEnd/assets/css.html.1990c5cf.js"><link rel="prefetch" href="/frontEnd/assets/html.html.adbeb0b0.js"><link rel="prefetch" href="/frontEnd/assets/JavaScript.html.9382241a.js"><link rel="prefetch" href="/frontEnd/assets/Git.html.70230868.js"><link rel="prefetch" href="/frontEnd/assets/nodejs.html.90c320ff.js"><link rel="prefetch" href="/frontEnd/assets/npm.html.77fb2927.js"><link rel="prefetch" href="/frontEnd/assets/index.html.f5280f9b.js"><link rel="prefetch" href="/frontEnd/assets/webpack.html.984a73b3.js"><link rel="prefetch" href="/frontEnd/assets/vue.html.6910cbfb.js"><link rel="prefetch" href="/frontEnd/assets/vuepress.html.7acb8d84.js"><link rel="prefetch" href="/frontEnd/assets/404.html.76c6f5d5.js"><link rel="prefetch" href="/frontEnd/assets/404.f9523724.js"><link rel="prefetch" href="/frontEnd/assets/Layout.a3266798.js">
    <link rel="stylesheet" href="/frontEnd/assets/style.a09127ea.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/frontEnd/" class=""><img class="logo" src="https://s1.ax1x.com/2022/06/17/XqwCNj.png" alt="AH"><span class="site-name can-hide">AH</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/frontEnd/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础笔记"><span class="title">前端基础笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础笔记"><span class="title">前端基础笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/frontEnd/html.html" class="" aria-label="html"><!--[--><!--]--> html <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/css.html" class="" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/JavaScript.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="必备技术"><span class="title">必备技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="必备技术"><span class="title">必备技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/nodejs.html" class="" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/frontEnd/zh/database/MongoDB.html" class="router-link-active router-link-exact-active router-link-active" aria-label="MongoDB"><!--[--><!--]--> MongoDB <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/webpack.html" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/Git.html" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue笔记"><span class="title">Vue笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue笔记"><span class="title">Vue笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vue/vue.html" class="" aria-label="vue2&amp;3"><!--[--><!--]--> vue2&amp;3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/vuepress.html" class="" aria-label="vuepress"><!--[--><!--]--> vuepress <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/frontEnd/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/uooo" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/frontEnd/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础笔记"><span class="title">前端基础笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础笔记"><span class="title">前端基础笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/frontEnd/html.html" class="" aria-label="html"><!--[--><!--]--> html <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/css.html" class="" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/JavaScript.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="必备技术"><span class="title">必备技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="必备技术"><span class="title">必备技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/nodejs.html" class="" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/frontEnd/zh/database/MongoDB.html" class="router-link-active router-link-exact-active router-link-active" aria-label="MongoDB"><!--[--><!--]--> MongoDB <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/webpack.html" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/nodejs/Git.html" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue笔记"><span class="title">Vue笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue笔记"><span class="title">Vue笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vue/vue.html" class="" aria-label="vue2&amp;3"><!--[--><!--]--> vue2&amp;3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/frontEnd/zh/vue/vuepress/vuepress.html" class="" aria-label="vuepress"><!--[--><!--]--> vuepress <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/frontEnd/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/uooo" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="mongodb" tabindex="-1"><a class="header-anchor" href="#mongodb" aria-hidden="true">#</a> MongoDB</h1><h2 id="mongodb简介" tabindex="-1"><a class="header-anchor" href="#mongodb简介" aria-hidden="true">#</a> MongoDB简介</h2><p>快速开发web应用的文档型数据库,比较自由的数据库,json和bson</p><p>.....</p><h2 id="mongodb启动" tabindex="-1"><a class="header-anchor" href="#mongodb启动" aria-hidden="true">#</a> MongoDB启动</h2><p>安装最新的,下载地址:<a href="http://dl.mongodb.org/dl/win32/x86_64" target="_blank" rel="noopener noreferrer">适用 win32 的下载包 (mongodb.org)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>进入mongo安装目录中的bin文件夹,在地址窗中输入cmd(把之前的路径删除在输入cmd回车),进入当前目录的cmd窗口输入mogod,启动MongoDB服务,服务常驻后台后,输入mongo可以输入js语法验证.</p><h2 id="概念" tabindex="-1"><a class="header-anchor" href="#概念" aria-hidden="true">#</a> 概念</h2><p>database=&gt;collection=&gt;document</p><p>一个数据库可有多个集合,一个集合可有多个文档,一般操作的就是文档</p><p><img src="http://img.ahait.cn/img/202206191615168.png" alt="image-20220619161528049"></p><p>查看数据库<code>show dbs</code>,查看当前使用的数据库<code>db</code>,使用某个数据库 <code>use 库名</code> ,查看数据库有多少集合 <code>show collections</code>,查看当前集合所有文档 <code>db.集合名.find()</code></p><p>数据库和文档不用我们创建,当目标的集合和数据库没有时候,他会自动创建</p><h2 id="数据的crud-增删改查" tabindex="-1"><a class="header-anchor" href="#数据的crud-增删改查" aria-hidden="true">#</a> 数据的CRUD(增删改查)</h2><blockquote><p>其实可以理解为js语句,对象操作其内部方法,再添加一些需要的参数.</p></blockquote><p>插入:insert不声明插入几个,insertone直插入一个,insertmany只插入多个;语义化</p><p>插入文档 db.集合名.insert(文档内容),例如db.c001.insert({name:&quot;Tom&quot;,age:18})</p><p>自动添加**_id**属性,确保文档数据唯一;也可以自己指定生成<code>db.c001.insert({_id:&quot;001&quot;,name:&quot;Tom&quot;,age:18})</code>,这也要确定唯一性.</p><hr><p><strong>查询</strong></p><p>db.集合名,find(查询条件),为空{}是查找全部:db.集合名,find({})</p><p>查询指定属性(字段)的文档:db.集合名.find({_id:&quot;????&quot;})</p><p>查询有多少个:db.集合名,find(查询条件).count()</p><p>$it小于, $gt 大于 ,$or[]或,$ite小于等于,$gte大于等于</p><p>例子查询出age大于20和小于10的人</p><p>db.num.find($or[{age:{$it:10}},{age:{$gt:20}}])</p><hr><p><strong>修改</strong></p><p>set ,unset</p><p>db.c1.update($unset{name:&quot;tom&quot;})</p><p>同时修改多个符合条件的文档</p><hr><p><strong>删除</strong></p><p>db.</p><h2 id="文档间关系" tabindex="-1"><a class="header-anchor" href="#文档间关系" aria-hidden="true">#</a> 文档间关系</h2><p>同数据关系:一对一,一对多,多对多</p><h2 id="导入数据" tabindex="-1"><a class="header-anchor" href="#导入数据" aria-hidden="true">#</a> 导入数据</h2><p>已有的json文件导入到数据库,</p><h2 id="p14排序和投影" tabindex="-1"><a class="header-anchor" href="#p14排序和投影" aria-hidden="true">#</a> P14排序和投影</h2><p><strong>sort()</strong></p><p>默认是按照_id的值排序的(升序:从小到大),sort()指定文档排序的规则</p><p><code>db.collection.find().sort(属性:1)</code>按照属性排序,1代表升序,-1代表降序</p><p>多规则排序(当有属性值相等时,按照什么规则)</p><p><code>db.collection.find().sort(属性:1,属性2:-1)</code></p><p><strong>投影</strong></p><p>仅仅显示想要看的一列(某一属性),比如仅仅想看name,_id是默认显示的,如果不显示设置为0</p><p><code>db.collection.find({},{name:1,_id:0})</code></p><h2 id="p15了解mongoose" tabindex="-1"><a class="header-anchor" href="#p15了解mongoose" aria-hidden="true">#</a> P15了解mongoose</h2><p>mongoose是通过nodejs里操作MongoDB的模块,管理数据库的对象文档模型(ODM)库,不用人工一个个插入删除.....数据库到node中全部变成对象,从而用对象的方式操作和管理mongodb</p><p><strong>新的对象</strong></p><ul><li>Schema(模式对象),一种约束,一种检验,验证.通过他对文档的操作进行约束,比如属性不能为空的限制....</li><li>Model,一个model相当于对应一个collection集合</li><li>Document,相对于collection中的数据文档</li></ul><p><strong>如何使用</strong></p><blockquote><p><a href="https://mongoosejs.com/docs/index.html" target="_blank" rel="noopener noreferrer">Mongoose v6.4.0: Getting Started (mongoosejs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>文档</p></blockquote><p>新建运行代码的文件夹,vscode控制台用npm安装mongoose,新建js文件,编写代码,用<strong>Code Runer</strong>插件运行js代码</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 引入mongoose</span>
<span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 连接MongoDB</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&#39;mongodb://localhost:27017/test&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 监听MongoDB连接状态</span>
<span class="token comment">// 一次性事件：连接成功,连接断开</span>
mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接成功&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接断开&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 断开数据库连接</span>
mongoose<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//一般不需要</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="p16了解schema和model" tabindex="-1"><a class="header-anchor" href="#p16了解schema和model" aria-hidden="true">#</a> P16了解schema和model</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb://localhost:27017/test&quot;</span><span class="token punctuation">)</span>
mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;连接成功&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 创建schema模式对象</span>
<span class="token keyword">var</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>
<span class="token keyword">var</span> stuSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span>String<span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span>String<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">&quot;female&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// gender 默认是女生</span>
    <span class="token literal-property property">adderss</span><span class="token operator">:</span>String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 通过schema来创建model,Model代表的是数据库的集合</span>
<span class="token comment">// 创建model,  mongoose.model(modelName, schema),通过模型操作数据库</span>
<span class="token comment">// modelName代表要应用的集合名字</span>
<span class="token keyword">const</span> stuModel <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&#39;student&#39;</span><span class="token punctuation">,</span> stuSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 向数据库插入文档</span>
stuModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;孙悟空&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">8888</span><span class="token punctuation">,</span>
    <span class="token literal-property property">adderss</span><span class="token operator">:</span><span class="token string">&quot;花果洞&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;插入成功!!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
stuModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;白骨精&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">7777</span><span class="token punctuation">,</span>
    <span class="token literal-property property">adderss</span><span class="token operator">:</span><span class="token string">&quot;白骨洞&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;插入成功!!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 自动吧集合名变成复数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="p17model的操作" tabindex="-1"><a class="header-anchor" href="#p17model的操作" aria-hidden="true">#</a> P17Model的操作</h2><p><strong>API</strong> model.js中很多方法的操作文档</p><p>find方法会返回一个doc,也就是查询的结果,返回的对象,就是document对象</p><p>model.find(condition,[projection],callbackfunction(err,doc))</p><p>findone,findbyid</p><p>update,updateone,updatemany</p><h2 id="p18实例document对象方法" tabindex="-1"><a class="header-anchor" href="#p18实例document对象方法" aria-hidden="true">#</a> P18实例document对象方法</h2><p>用doc操作数据库,doc.save(),doc.remove(),doc.set(&quot;属性&quot;,&quot;修改的新值&quot;)</p><p>每次doc操作后一定要doc.save()</p><p>tojson字符串对象,toObject转换为普通对象</p><p>删除对象属性 delete doc.address不可以,需要先toObject然后再删除</p><h2 id="p19模块化的mongoose" tabindex="-1"><a class="header-anchor" href="#p19模块化的mongoose" aria-hidden="true">#</a> P19模块化的mongoose</h2><p>让连接数据库,新建schema变得更加方便</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/frontEnd/assets/app.a5758758.js" defer></script>
  </body>
</html>
